<div class="auth-container">
  <main class="auth-content">
    <!-- Panel izquierdo - Bienvenida -->
    <aside class="welcome-panel" aria-label="Informaci√≥n de la aplicaci√≥n">
      <div class="welcome-content">
        <div class="logo-section">
          <img class="logo" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Ctext x='0' y='28' font-size='32'%3E%F0%9F%8F%86%3C/text%3E%3C/svg%3E" alt="Trofeo, icono de Family Points" style="width: 2em; height: 2em;" />
          <h1 class="app-title">Family Points</h1>
          <p class="app-subtitle">Planifica actividades familiares y gestiona puntos por tareas cotidianas</p>
        </div>

        <figure class="illustration" aria-label="Ilustraci√≥n de una familia">
          <figcaption class="sr-only">Ilustraci√≥n de una familia</figcaption>
          <div class="family-icons">
            <span class="family-member dad">
              <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Ctext x='0' y='28' font-size='32'%3E%F0%9F%91%A8%3C/text%3E%3C/svg%3E" alt="Pap√°" style="width: 2em; height: 2em;" />
            </span>
            <span class="family-member mom">
              <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Ctext x='0' y='28' font-size='32'%3E%F0%9F%91%A9%3C/text%3E%3C/svg%3E" alt="Mam√°" style="width: 2em; height: 2em;" />
            </span>
            <span class="family-member kid">
              <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Ctext x='0' y='28' font-size='32'%3E%F0%9F%91%A7%3C/text%3E%3C/svg%3E" alt="Hija" style="width: 2em; height: 2em;" />
            </span>
          </div>
          <div class="floating-elements" aria-hidden="true">
            <span class="floating-star star1">‚≠ê</span>
            <span class="floating-star star2">‚ú®</span>
            <span class="floating-star star3">üåü</span>
          </div>
        </figure>

        <div class="features">
          <div class="feature">
            <span class="feature-icon">
              <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Ctext x='0' y='28' font-size='32'%3E%F0%9F%93%85%3C/text%3E%3C/svg%3E" alt="Calendario" style="width: 1.5em; height: 1.5em;" />
            </span>
            <span>Planifica eventos familiares</span>
          </div>
          <div class="feature">
            <span class="feature-icon">
              <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Ctext x='0' y='28' font-size='32'%3E%F0%9F%8E%AF%3C/text%3E%3C/svg%3E" alt="Objetivo" style="width: 1.5em; height: 1.5em;" />
            </span>
            <span>Asigna tareas y puntos</span>
          </div>
          <div class="feature">
            <span class="feature-icon">
              <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3E%3Ctext x='0' y='28' font-size='32'%3E%F0%9F%8F%86%3C/text%3E%3C/svg%3E" alt="Trofeo" style="width: 1.5em; height: 1.5em;" />
            </span>
            <span>Compite en familia</span>
          </div>
        </div>
      </div>
    </aside>

    <!-- Panel derecho - Formularios -->
    <section class="form-panel">
      <div class="form-container">
        <header class="form-header">
          <h2 id="form-title">{{ currentTab === 'login' ? '¬°Bienvenido de vuelta!' : '¬°√önete a la diversi√≥n!' }}</h2>
          <p id="form-description">{{ currentTab === 'login' ? 'Accede a tu cuenta familiar' : 'Crea tu cuenta familiar' }}</p>
        </header>

        <div class="auth-tabs" role="tablist" aria-label="Tipo de formulario">
          <button
            type="button"
            role="tab"
            class="tab-button"
            [class.active]="currentTab === 'login'"
            [attr.aria-selected]="currentTab === 'login'"
            [attr.aria-controls]="'login-form'"
            [attr.tabindex]="currentTab === 'login' ? 0 : -1"
            (click)="setCurrentTab('login')"
            (keydown.ArrowRight)="setCurrentTab('register')"
            (keydown.ArrowLeft)="setCurrentTab('register')">
            Iniciar Sesi√≥n
          </button>
          <button
            type="button"
            role="tab"
            class="tab-button"
            [class.active]="currentTab === 'register'"
            [attr.aria-selected]="currentTab === 'register'"
            [attr.aria-controls]="'register-form'"
            [attr.tabindex]="currentTab === 'register' ? 0 : -1"
            (click)="setCurrentTab('register')"
            (keydown.ArrowRight)="setCurrentTab('login')"
            (keydown.ArrowLeft)="setCurrentTab('login')">
            Registrarse
          </button>
        </div>

        <div class="form-wrapper">
          <!-- Formulario de Login -->
          <form
            *ngIf="currentTab === 'login'"
            (ngSubmit)="onLogin()"
            class="auth-form"
            id="login-form"
            role="tabpanel"
            [attr.aria-labelledby]="'form-title'"
            [attr.aria-describedby]="'form-description'"
            novalidate>

            <div class="form-fields">
              <div class="form-group">
                <label for="login-username">
                  <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext x='0' y='20' font-size='24'%3E%F0%9F%91%A4%3C/text%3E%3C/svg%3E" alt="Usuario" style="width:1.2em;height:1.2em;vertical-align:middle;" /> Usuario
                </label>
                <input
                  id="login-username"
                  type="text"
                  [(ngModel)]="loginData.username"
                  name="username"
                  placeholder="Tu nombre de usuario"
                  autocomplete="username"
                  aria-describedby="login-username-help"
                  [attr.aria-invalid]="loginUsernameInvalid"
                  required>
                <div id="login-username-help" class="sr-only">
                  Ingresa tu nombre de usuario para iniciar sesi√≥n
                </div>
              </div>

              <div class="form-group">
                <label for="login-password">
                  <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext x='0' y='20' font-size='24'%3E%F0%9F%94%92%3C/text%3E%3C/svg%3E" alt="Contrase√±a" style="width:1.2em;height:1.2em;vertical-align:middle;" /> Contrase√±a
                </label>
                <input
                  id="login-password"
                  type="password"
                  [(ngModel)]="loginData.password"
                  name="password"
                  placeholder="Tu contrase√±a"
                  autocomplete="current-password"
                  aria-describedby="login-password-help"
                  [attr.aria-invalid]="loginPasswordInvalid"
                  required>
                <div id="login-password-help" class="sr-only">
                  Ingresa tu contrase√±a para iniciar sesi√≥n
                </div>
              </div>
            </div>

            <button
              type="submit"
              class="btn-primary submit-btn"
              [disabled]="isLoading"
              [attr.aria-describedby]="isLoading ? 'loading-message' : null">
              <span *ngIf="isLoading" id="loading-message">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext x='0' y='20' font-size='24'%3E%F0%9F%94%84%3C/text%3E%3C/svg%3E" alt="Cargando" style="width:1.2em;height:1.2em;vertical-align:middle;" /> Iniciando sesi√≥n...
              </span>
              <span *ngIf="!isLoading">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext x='0' y='20' font-size='24'%3E%F0%9F%9A%80%3C/text%3E%3C/svg%3E" alt="Cohete" style="width:1.2em;height:1.2em;vertical-align:middle;" /> Iniciar Sesi√≥n
              </span>
            </button>
          </form>

          <!-- Formulario de Registro -->
          <form
            *ngIf="currentTab === 'register'"
            (ngSubmit)="onRegister()"
            class="auth-form"
            id="register-form"
            role="tabpanel"
            [attr.aria-labelledby]="'form-title'"
            [attr.aria-describedby]="'form-description'"
            novalidate>

            <div class="form-fields">
              <div class="form-group">
                <label for="register-username">
                  <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext x='0' y='20' font-size='24'%3E%F0%9F%91%A4%3C/text%3E%3C/svg%3E" alt="Usuario" style="width:1.2em;height:1.2em;vertical-align:middle;" /> Usuario
                </label>
                <input
                  id="register-username"
                  type="text"
                  [(ngModel)]="registerData.username"
                  name="regUsername"
                  placeholder="Elige un nombre de usuario"
                  autocomplete="username"
                  aria-describedby="register-username-help"
                  [attr.aria-invalid]="registerUsernameInvalid"
                  required>
                <div id="register-username-help" class="sr-only">
                  Elige un nombre de usuario √∫nico para tu cuenta
                </div>
              </div>

              <div class="form-group">
                <label for="register-email">
                  <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext x='0' y='20' font-size='24'%3E%F0%9F%93%A7%3C/text%3E%3C/svg%3E" alt="Email" style="width:1.2em;height:1.2em;vertical-align:middle;" /> Email
                </label>
                <input
                  id="register-email"
                  type="email"
                  [(ngModel)]="registerData.email"
                  name="email"
                  placeholder="tu@email.com"
                  autocomplete="email"
                  aria-describedby="register-email-help"
                  [attr.aria-invalid]="registerEmailInvalid"
                  required>
                <div id="register-email-help" class="sr-only">
                  Ingresa un email v√°lido para tu cuenta
                </div>
              </div>

              <div class="form-group">
                <label for="register-family">
                  <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext x='0' y='20' font-size='24'%3E%F0%9F%8F%A0%3C/text%3E%3C/svg%3E" alt="Casa" style="width:1.2em;height:1.2em;vertical-align:middle;" /> Nombre de tu Familia
                </label>
                <input
                  id="register-family"
                  type="text"
                  [(ngModel)]="registerData.familyName"
                  name="familyName"
                  placeholder="Familia Gonz√°lez"
                  aria-describedby="register-family-help"
                  [attr.aria-invalid]="registerFamilyInvalid"
                  required>
                <div id="register-family-help" class="sr-only">
                  Nombre que aparecer√° para identificar a tu familia
                </div>
              </div>

              <div class="form-group">
                <fieldset>
                  <legend>
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext x='0' y='20' font-size='24'%3E%F0%9F%8E%AD%3C/text%3E%3C/svg%3E" alt="M√°scara" style="width:1.2em;height:1.2em;vertical-align:middle;" /> Elige tu Avatar
                  </legend>
                  <div class="avatar-selector" aria-describedby="avatar-help">
                    <ng-container *ngFor="let avatar of avatarOptions; trackBy: trackByAvatar">
                      <label class="avatar-option" [class.selected]="registerData.avatar === avatar">
                        <input
                          type="radio"
                          name="avatar"
                          [value]="avatar"
                          [(ngModel)]="registerData.avatar"
                          [attr.aria-label]="'Avatar ' + avatar"
                        />
                        <span aria-hidden="true">{{avatar}}</span>
                      </label>
                    </ng-container>
                  </div>
                  <div id="avatar-help" class="sr-only">
                    Selecciona un emoji que te represente en la aplicaci√≥n
                  </div>
                </fieldset>
              </div>

              <div class="form-group">
                <label for="register-password">
                  <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext x='0' y='20' font-size='24'%3E%F0%9F%94%92%3C/text%3E%3C/svg%3E" alt="Contrase√±a" style="width:1.2em;height:1.2em;vertical-align:middle;" /> Contrase√±a
                </label>
                <input
                  id="register-password"
                  type="password"
                  [(ngModel)]="registerData.password"
                  name="regPassword"
                  placeholder="Crea una contrase√±a segura"
                  autocomplete="new-password"
                  aria-describedby="register-password-help"
                  [attr.aria-invalid]="registerPasswordInvalid"
                  required>
                <div id="register-password-help" class="sr-only">
                  Crea una contrase√±a segura para proteger tu cuenta
                </div>
              </div>
            </div>

            <button
              type="submit"
              class="btn-primary submit-btn"
              [disabled]="isLoading"
              [attr.aria-describedby]="isLoading ? 'loading-message-register' : null">
              <span *ngIf="isLoading" id="loading-message-register">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext x='0' y='20' font-size='24'%3E%F0%9F%94%84%3C/text%3E%3C/svg%3E" alt="Cargando" style="width:1.2em;height:1.2em;vertical-align:middle;" /> Creando cuenta...
              </span>
              <span *ngIf="!isLoading">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24'%3E%3Ctext x='0' y='20' font-size='24'%3E%E2%9C%A8%3C/text%3E%3C/svg%3E" alt="Estrella" style="width:1.2em;height:1.2em;vertical-align:middle;" /> Crear Cuenta
              </span>
            </button>
          </form>
        </div>

        <!-- Mensajes de error -->
        <div
          *ngIf="errorMessage"
          class="error-message"
          role="alert"
          aria-live="polite"
          id="error-alert">
          <span aria-hidden="true">‚ö†Ô∏è</span> {{errorMessage}}
        </div>

        <!-- Usuarios de demo -->
        <section class="demo-section" *ngIf="currentTab === 'login'" aria-labelledby="demo-title">
          <h3 id="demo-title">
            <span aria-hidden="true">üë•</span> Familias de Demostraci√≥n
          </h3>
          <p>Prueba con estas familias de ejemplo:</p>
          <ul class="demo-users">
            <li *ngFor="let user of demoUsers; trackBy: trackByUser">
              <button
                type="button"
                class="demo-user-btn"
                [attr.aria-label]="'Iniciar sesi√≥n como ' + user.familyName"
                (click)="loginAsDemo(user)">
                <span class="demo-avatar" [attr.aria-label]="'Avatar ' + user.avatar">{{user.avatar}}</span>
                <span class="demo-name">{{user.familyName}}</span>
              </button>
            </li>
          </ul>
        </section>
      </div>
    </section>
  </main>
</div>

<!-- Clase utilitaria para lectores de pantalla -->
<style>
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}
</style>
